*** 2019-01-08 20:31:45,345 - libarchive.library - DEBUG ***
Using default library file-path: [libarchive.so]
******

*** 2019-01-08 20:31:45,345 - libarchive.library - DEBUG ***
Using library file-path: [libarchive.so]
******

*** 2019-01-08 20:31:45,351 - code.resnet_fastai - DEBUG ***
Start a new training task
******

*** 2019-01-08 20:31:45,351 - code.resnet_fastai - INFO ***
Device ID: 0
Image size: 1024
Network architecture: resnet
Loss function: bce
Sampler: random
Encoder depth: 50
Dropout: 0.5
Threshold: 0.2
Stage 1 #epoch: 3
Stage 2 #epoch: 30
Learning rate #1: 0.0018
Learning rate #2: 7e-07
Batch size: 4
Dataset: official_hpav18
Dataset directory: data/hpa1024
Output directory: output
******

*** 2019-01-08 20:31:45,351 - code.resnet_fastai - INFO ***
official_hpav18 stats: ([0.08181731294659297, 0.05393953952823462, 0.05515322176105104, 0.08418251280411483], [0.14912430271152502, 0.11185498801507318, 0.15687271707973055, 0.14903431519537524])
******

*** 2019-01-08 20:31:45,351 - code.resnet_fastai - INFO ***
official stats: ([0.08181731294659297, 0.05393953952823462, 0.05515322176105104, 0.08418251280411483], [0.14912430271152502, 0.11185498801507318, 0.15687271707973055, 0.14903431519537524])
******

*** 2019-01-08 20:31:45,351 - code.resnet_fastai - INFO ***
hpav18 stats: ([0.11810116173772936, 0.06795416990341785, 0.06612933906943513, 0.08437984839655913], [0.17499094128737935, 0.12197690061419421, 0.17568283970650891, 0.11266782268834614])
******

*** 2019-01-08 20:31:45,385 - code.resnet_fastai - DEBUG ***
# Test ids: 11702
******

*** 2019-01-08 20:31:45,445 - code.resnet_fastai - DEBUG ***
official train size: (31072, 2)
******

*** 2019-01-08 20:31:45,467 - code.resnet_fastai - DEBUG ***
hpav18 train size: (71437, 2)
******

*** 2019-01-08 20:31:45,468 - code.resnet_fastai - DEBUG ***
empty size (0, 2)
******

*** 2019-01-08 20:31:46,014 - code.resnet_fastai - DEBUG ***
hpav18 rare size: (7404, 2)
******

*** 2019-01-08 20:31:46,015 - code.resnet_fastai - DEBUG ***
concat size: (38476, 2)
******

*** 2019-01-08 20:31:46,651 - code.resnet_fastai - DEBUG ***
oversample train size: (45767, 2)
******

*** 2019-01-08 20:31:49,769 - code.resnet_fastai - DEBUG ***
Start of fold 1
******

*** 2019-01-08 20:31:49,769 - code.resnet_fastai - DEBUG ***
Size of valid set: 9137
******

*** 2019-01-08 20:31:49,886 - code.resnet_fastai - DEBUG ***
LabelList
y: MultiCategoryList (36630 items)
[MultiCategory 16;0, MultiCategory 7;1;2;0, MultiCategory 5, MultiCategory 1, MultiCategory 18]...
Path: data/hpa1024
x: ImageItemList (36630 items)
[Image (4, 1024, 1024), Image (4, 1024, 1024), Image (4, 1024, 1024), Image (4, 1024, 1024), Image (4, 1024, 1024)]...
Path: data/hpa1024
******

*** 2019-01-08 20:31:50,202 - code.resnet_fastai - DEBUG ***
LabelList
y: MultiCategoryList (9137 items)
[MultiCategory 24;0, MultiCategory 25;0, MultiCategory 0, MultiCategory 25;11, MultiCategory 11]...
Path: data/hpa1024
x: ImageItemList (9137 items)
[Image (4, 1024, 1024), Image (4, 1024, 1024), Image (4, 1024, 1024), Image (4, 1024, 1024), Image (4, 1024, 1024)]...
Path: data/hpa1024
******

*** 2019-01-08 20:31:51,093 - code.resnet_fastai - DEBUG ***
Databunch created
******

*** 2019-01-08 20:31:51,093 - code.resnet_fastai - INFO ***
Initialising model.
******

*** 2019-01-08 20:31:51,689 - code.resnet_fastai - INFO ***
Complete initialising model.
******

*** 2019-01-08 20:31:51,695 - code.resnet_fastai - INFO ***
Use half precision float.
******

*** 2019-01-08 20:31:51,695 - code.resnet_fastai - INFO ***
No pretrained model.
******

*** 2019-01-08 20:31:51,695 - code.resnet_fastai - INFO ***
Start model fitting: Stage 1
******

*** 2019-01-08 20:31:51,695 - code.resnet_fastai - DEBUG ***
LR: 0.0018
******

[0.00018 0.00018 0.0018 ]
epoch     train_loss  valid_loss  fbeta   
1         0.171507    0.152061    0.489534  
2         0.154109    0.746513    0.557260  
*** 2019-01-08 22:55:17,577 - code.resnet_fastai - INFO ***
Complete model fitting: Stage 1
******

*** 2019-01-08 22:55:17,662 - code.resnet_fastai - INFO ***
Stage 1 model saved.
******

*** 2019-01-08 22:55:17,662 - code.resnet_fastai - INFO ***
Start model fitting: Stage 2
******

*** 2019-01-08 22:55:17,663 - code.resnet_fastai - DEBUG ***
Unfreezing model
******

*** 2019-01-08 22:55:17,663 - code.resnet_fastai - DEBUG ***
LR: 7e-07
******

3         0.151716    0.177866    0.574653  
[7.000000e-07 9.899495e-06 1.400000e-04]
epoch     train_loss  valid_loss  fbeta   
1         0.153066    0.491819    0.538340  
2         0.152982    0.382676    0.559197  
3         0.143079    0.159873    0.596255  
4         0.142783    0.170340    0.607865  
5         0.137749    0.991881    0.620544  
6         0.131410    0.758593    0.603119  
7         0.140951    2.072380    0.611270  
8         0.134032    0.224432    0.645073  
*** 2019-01-09 07:48:36,009 - code.resnet_fastai - INFO ***
Complete model fitting: Stage 2
******

*** 2019-01-09 07:48:36,053 - code.resnet_fastai - INFO ***
Stage 2 model saved.
******

*** 2019-01-09 07:48:36,053 - code.resnet_fastai - INFO ***
Start predicting test set
******

9         0.131741    0.222888    0.646607  
Epoch 9: early stopping
Epoch 9: reducing lr to 2.8000000000000003e-05
*** 2019-01-09 07:55:33,710 - code.resnet_fastai - INFO ***
Complete test prediction.
******

*** 2019-01-09 07:55:33,714 - code.resnet_fastai - INFO ***
Prediction saved.
******

*** 2019-01-09 07:55:33,785 - code.resnet_fastai - INFO ***
Results written to output/resnet50-1024-official_hpav18-bce-random-drop0.5-th0.2-bs4-lr0.0018_7e-07-ep3_30-1.csv. Finished! :)
******

*** 2019-01-09 07:55:33,787 - code.resnet_fastai - DEBUG ***
torch.Size([11702, 28])
******

*** 2019-01-09 07:55:33,834 - code.resnet_fastai - INFO ***
Results written to output/resnet50-1024-official_hpav18-bce-random-drop0.5-th0.2-bs4-lr0.0018_7e-07-ep3_30-avg.csv. Finished! :)
******

