*** 2019-01-07 23:03:16,670 - libarchive.library - DEBUG ***
Using default library file-path: [libarchive.so]
******

*** 2019-01-07 23:03:16,671 - libarchive.library - DEBUG ***
Using library file-path: [libarchive.so]
******

*** 2019-01-07 23:03:16,677 - code.resnet_fastai - DEBUG ***
Start a new training task
******

*** 2019-01-07 23:03:16,677 - code.resnet_fastai - INFO ***
Device ID: 0
Image size: 1024
Network architecture: resnet
Loss function: bce
Sampler: random
Encoder depth: 50
Dropout: 0.5
Threshold: 0.1
Stage 1 #epoch: 3
Stage 2 #epoch: 30
Learning rate #1: 0.0015
Learning rate #2: 8.75e-07
Batch size: 4
Dataset: official_hpav18
Dataset directory: data/hpa1024
Output directory: output
******

*** 2019-01-07 23:03:16,677 - code.resnet_fastai - INFO ***
official_hpav18 stats: ([0.08181731294659297, 0.05393953952823462, 0.05515322176105104, 0.08418251280411483], [0.14912430271152502, 0.11185498801507318, 0.15687271707973055, 0.14903431519537524])
******

*** 2019-01-07 23:03:16,677 - code.resnet_fastai - INFO ***
official stats: ([0.08181731294659297, 0.05393953952823462, 0.05515322176105104, 0.08418251280411483], [0.14912430271152502, 0.11185498801507318, 0.15687271707973055, 0.14903431519537524])
******

*** 2019-01-07 23:03:16,677 - code.resnet_fastai - INFO ***
hpav18 stats: ([0.11810116173772936, 0.06795416990341785, 0.06612933906943513, 0.08437984839655913], [0.17499094128737935, 0.12197690061419421, 0.17568283970650891, 0.11266782268834614])
******

*** 2019-01-07 23:03:16,711 - code.resnet_fastai - DEBUG ***
# Test ids: 11702
******

*** 2019-01-07 23:03:16,774 - code.resnet_fastai - DEBUG ***
official train size: (31072, 2)
******

*** 2019-01-07 23:03:16,798 - code.resnet_fastai - DEBUG ***
hpav18 train size: (71437, 2)
******

*** 2019-01-07 23:03:16,798 - code.resnet_fastai - DEBUG ***
empty size (0, 2)
******

*** 2019-01-07 23:03:17,374 - code.resnet_fastai - DEBUG ***
hpav18 rare size: (7404, 2)
******

*** 2019-01-07 23:03:17,375 - code.resnet_fastai - DEBUG ***
concat size: (38476, 2)
******

*** 2019-01-07 23:03:18,058 - code.resnet_fastai - DEBUG ***
oversample train size: (45767, 2)
******

*** 2019-01-07 23:03:21,648 - code.resnet_fastai - DEBUG ***
Start of fold 0
******

*** 2019-01-07 23:03:21,648 - code.resnet_fastai - DEBUG ***
Size of valid set: 9180
******

*** 2019-01-07 23:03:21,760 - code.resnet_fastai - DEBUG ***
LabelList
y: MultiCategoryList (36587 items)
[MultiCategory 16;0, MultiCategory 7;1;2;0, MultiCategory 5, MultiCategory 1, MultiCategory 18]...
Path: data/hpa1024
x: ImageItemList (36587 items)
[Image (4, 1024, 1024), Image (4, 1024, 1024), Image (4, 1024, 1024), Image (4, 1024, 1024), Image (4, 1024, 1024)]...
Path: data/hpa1024
******

*** 2019-01-07 23:03:22,080 - code.resnet_fastai - DEBUG ***
LabelList
y: MultiCategoryList (9180 items)
[MultiCategory 7, MultiCategory 24;0, MultiCategory 25, MultiCategory 0, MultiCategory 11]...
Path: data/hpa1024
x: ImageItemList (9180 items)
[Image (4, 1024, 1024), Image (4, 1024, 1024), Image (4, 1024, 1024), Image (4, 1024, 1024), Image (4, 1024, 1024)]...
Path: data/hpa1024
******

*** 2019-01-07 23:03:22,951 - code.resnet_fastai - DEBUG ***
Databunch created
******

*** 2019-01-07 23:03:22,952 - code.resnet_fastai - INFO ***
Initialising model.
******

*** 2019-01-07 23:03:23,569 - code.resnet_fastai - INFO ***
Complete initialising model.
******

*** 2019-01-07 23:03:23,576 - code.resnet_fastai - INFO ***
Use half precision float.
******

*** 2019-01-07 23:03:23,576 - code.resnet_fastai - INFO ***
No pretrained model.
******

*** 2019-01-07 23:03:23,576 - code.resnet_fastai - INFO ***
Start model fitting: Stage 1
******

*** 2019-01-07 23:03:23,576 - code.resnet_fastai - DEBUG ***
LR: 0.0015
******

[0.00015 0.00015 0.0015 ]
epoch     train_loss  valid_loss  fbeta   
1         0.170891    0.156542    0.472412  
2         0.154743    0.135208    0.559139  
*** 2019-01-08 01:30:08,341 - code.resnet_fastai - INFO ***
Complete model fitting: Stage 1
******

*** 2019-01-08 01:30:08,426 - code.resnet_fastai - INFO ***
Stage 1 model saved.
******

*** 2019-01-08 01:30:08,426 - code.resnet_fastai - INFO ***
Start model fitting: Stage 2
******

*** 2019-01-08 01:30:08,427 - code.resnet_fastai - DEBUG ***
Unfreezing model
******

*** 2019-01-08 01:30:08,427 - code.resnet_fastai - DEBUG ***
LR: 8.75e-07
******

3         0.148451    0.131293    0.587282  
[8.750000e-07 1.237437e-05 1.750000e-04]
epoch     train_loss  valid_loss  fbeta   
1         0.146507    0.130961    0.583821  
2         0.143536    0.132456    0.586801  
3         0.146771    0.125895    0.605248  
4         0.138671    0.121563    0.626044  
5         0.141348    0.117997    0.635899  
6         0.143462    0.117129    0.648267  
7         0.134467    0.113109    0.660583  
8         0.142680    0.110399    0.664571  
9         0.122395    0.110633    0.649795  
10        0.122455    0.108946    0.679221  
11        0.121576    0.103697    0.695938  
12        0.120732    0.104423    0.695017  
13        0.118283    0.732375    0.673422  
14        0.125623    0.105868    0.705331  
15        0.123619    0.475785    0.689152  
16        0.112786    0.107247    0.695778  
*** 2019-01-08 20:06:35,129 - code.resnet_fastai - INFO ***
Complete model fitting: Stage 2
******

*** 2019-01-08 20:06:35,176 - code.resnet_fastai - INFO ***
Stage 2 model saved.
******

*** 2019-01-08 20:06:35,176 - code.resnet_fastai - INFO ***
Start predicting test set
******

17        0.111162    0.115193    0.710302  
Epoch 17: early stopping
Epoch 17: reducing lr to 2.3893512352540216e-05
*** 2019-01-08 20:13:31,427 - code.resnet_fastai - INFO ***
Complete test prediction.
******

*** 2019-01-08 20:13:31,429 - code.resnet_fastai - INFO ***
Prediction saved.
******

*** 2019-01-08 20:13:31,526 - code.resnet_fastai - INFO ***
Results written to output/resnet50-1024-official_hpav18-bce-random-drop0.5-th0.1-bs4-lr0.0015_8.75e-07-ep3_30-0.csv. Finished! :)
******

*** 2019-01-08 20:13:31,530 - code.resnet_fastai - DEBUG ***
torch.Size([11702, 28])
******

